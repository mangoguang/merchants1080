function lazyload(){countryBtn(),provinceBtn(),cityBtn(),ajaxObj={country:"中国"},barOption(ajaxObj,""),ajaxObj1={},addzsryLi(ajaxObj1)}function barOption(t,a){getData1(dataPath+"brandbyinfo",t).then(function(t){tryFun=function(){canClick=!0;for(var e=t.area,n=[],o=0;o<e.length;o++)n.push(e[o][0]);for(var i=[],r=t.brandMsg,o=0;o<r.length;o++)i.push(r[o].brand);i.unshift("全部"),brandState&&(brandsArr=i,brandState=!1),brandList=i,addBrandList(brandsArr,a),addzsryList(brandsArr),barList();var s=[],l=[];l.length=r.length;for(var o=0;o<r.length;o++)l[o]=[],s.push(r[o].brandInfo);for(var o=0;o<s.length;o++)for(var c=0;c<s[o].length;c++)l[o].push(s[o][c].QTY);var p=[];l.unshift(p);for(var d=[],o=0;o<brandList.length;o++){var h={name:brandList[o],type:"bar",stack:"总量",label:{normal:{show:labelShow,position:"right"}},data:l[o]};d.push(h)}var m=echarts.init(document.getElementById("barGraph"));Baroption={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"6%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value",axisLabel:{textStyle:{color:textColor,fontSize:12}},axisLine:{lineStyle:{color:textColor}},splitLine:{show:!1}},yAxis:{type:"category",axisLabel:{textStyle:{color:textColor,fontSize:12}},axisLine:{lineStyle:{color:textColor,fontSize:12}},axisTick:{show:!1},inverse:!0,data:n},series:d},m.setOption(Baroption)};try{tryFun()}catch(t){alert("你的网络有问题。")}})}function addBrandList(t,a){$(".barLengend").empty();var e="";for(i in t){var n='<li class="li'+i+'"><span></span>'+t[i]+"</li>";e+=n}if($(".barLengend").append(e),""!=a)for(i in t)t[i]==a&&$(".barLengend .li"+i).addClass("on")}function addProvinceLi(){$(".provincesList").empty();for(var t="",a=0;a<provinces.length;a++){var e="<li><p>"+provinces[a]+"</p></li>";t+=e}$(".provincesList").append(t),provinceBtn(),ajaxObj={country:"中国",province:"广东"},getData1(dataPath+"brandbyinfo",ajaxObj).then(function(t){$(".citysList").empty();for(var a=t.area,e="",n=0;n<a.length;n++){var o="<li><p>"+a[n][0]+"</p></li>";e+=o}$(".citysList").append(e)})}function countryBtn(){$(".countrysList li").click(function(){labelShow=!1,$(".barLengend").addClass("on"),delete ajaxObj.brand;var t=$(this).text();"中国"==t?($(".hideBox").show(),addProvinceLi(),$(".citysListBox").hide()):($(".hideBox").hide(),addOtherCountry(t)),$(".provinceBtn").text("省"),$(this).parent().hide(500);var a=$(this).text();$(this).parent().siblings().text(a),$(".unDevelopBox").hide(),ajaxObj={country:a},barOption(ajaxObj,"")})}function provinceBtn(){$(".provincesList li").click(function(){labelShow=!1,$(".barLengend").addClass("on"),delete ajaxObj.brand,$(".citysListBox > h2").text("市"),$(this).parent().hide(500),$(".citysListBox").show(500);var t=$(this).text();$(this).parent().siblings().text(t);var a={country:"中国",province:t};getData1(dataPath+"distributeinfo",a).then(function(t){t=t.detailCount;for(var a="",e=0;e<t.length;e++)a=a+"<li>"+t[e].cityName+"</li>";$(".citysList").empty(),$(".citysList").append(a),cityBtn()});var a={province:t};getData1(dataPath+"voidmarkets",a).then(function(t){var a=t.unDevelop;a=a.split(",");for(var e="",n=0;n<a.length;n++){var o="<li>"+a[n]+"</li>";e+=o}$(".unDevelopBox ul").empty(),$(".unDevelopBox ul").append(e)}),$(".unDevelopBox").show(),ajaxObj={country:"中国",province:t},barOption(ajaxObj,"")})}function cityBtn(){$(".citysList li").click(function(){labelShow=!1,$(".barLengend").addClass("on"),delete ajaxObj.brand,$(this).parent().hide(500);var t=$(this).text();$(this).parent().siblings().text(t);var a=$(".provinceBtn").text();$(".unDevelopBox").hide(),ajaxObj={country:"中国",province:a,city:t},barOption(ajaxObj,"")})}function barList(){$(".barLengend li").off("click").click(function(){if(canClick){canClick=!1;var t=$(this).text();"全部"==t?(labelShow=!1,$(".barLengend").addClass("on"),delete ajaxObj.brand,barOption(ajaxObj,"")):(labelShow=!0,$(".barLengend").removeClass("on"),$(this).addClass("on"),$(this).siblings().removeClass("on"),ajaxObj.brand=t,barOption(ajaxObj,t))}})}function load(){$(".barGraphBox").css({background:"url(image1080/1-background2.png) no-repeat","background-size":"100% 100%"}),$(".bottomNav").css({background:"url(image1080/7-menuon.png) no-repeat","background-size":"1144px 140px"})}function zsryBtn(){$(".zsrySelect").click(function(){$(".zsrySelect ul").toggle()})}function addzsryList(t){var a="";$(".zsryBox").empty();for(i in t){var e="<li>"+t[i]+"</li>";a+=e}$(".zsryBox").append(a),zsryLiClick()}function zsryLiClick(){$(".zsryBox li").off("click").click(function(){var t=$(this).text();$(".zsryBtn").html(t),ajaxObj1="全部"==t?{}:{brand:t},addzsryLi(ajaxObj1)})}function addzsryLi(t){console.log(t),getData1(dataPath1+"gettuozhan",t).then(function(t){if(console.log(t),t.length>0){$(".kzryList").empty();var a="";for(i in t){var e=t[i].AREA;if(e.length>26)var n="<button class='moreBtn'>显示全部</button>";else var n="";var o="<li><img class='headPhoto' src='"+picPath+t[i].MULU+"/"+t[i].HEADPHOTO+"'/><div><h3>"+t[i].NAME+"<span>"+t[i].BRAND+"</span></h3><p>电话："+t[i].PHONE+"</p><p>职位："+t[i].POSITION+"</p><p class='moreBox'>负责区域："+e+"</p>"+n+"</div><img class='QR' src='"+picPath+t[i].MULU+"/"+t[i].QRPIC+"'/></li>";a+=o}$(".kzryList").append(a),$(".moreBtn").off("click").click(function(){$(this).hide(),$(this).siblings(".moreBox").css("max-height","1000px")})}else $(".kzryList").empty(),$(".kzryList").append('<p class="noMenMsg">该品牌暂时没有设置拓展人员！</p>')})}var geoTop=170,geoLeft=20,selectedMode=!0,mapName="world",wjson,provinces=["广东","安徽","澳门","北京","重庆","福建","甘肃","广西","贵州","海南","河北","黑龙江","河南","湖北","湖南","江苏","江西","吉林","辽宁","内蒙古","宁夏","青海","山东","上海","山西","四川","天津","香港","新疆","西藏","云南","浙江"],CNname=[],ENname=[],sum=[],brandsArr,labelShow=!1,ajaxObj={},ajaxObj1={},brandList=[],brandState=!0,canClick=!0;$(document).ready(function(){var t=document.documentElement.clientHeight;$(".deviceHeight").css("height",t-40-deviceTopHeight),$("#worldBody").height(t),$(".barGraphBox").height(t-230),$(".barGraph").height(t-280),$(".unDevelopBox").height(t-200),$(".kzryMsgBox").height(t),$(".kzryList").height(t-200),addStoreMsg(),$("#slidBar>.list").click(function(){$(this).siblings().removeClass("on"),$(this).addClass("on"),$(".listBox").show(500)}),$("#slidBar>.map").click(function(){$(this).siblings().removeClass("on"),$(this).addClass("on"),$(".listBox").hide(500)}),$(".countryListBox").scroll(function(){var t=$(this).scrollTop();t>50?$(".scroll1").addClass("scrollTop"):$(".scroll1").removeClass("scrollTop"),t>1320?$(".scroll2").removeClass("scrollBottom"):$(".scroll2").addClass("scrollBottom")}),$(".selectBox h2").click(function(){var t=$(this).siblings().css("display");$(".selectBox ul").hide(),"none"==t?$(this).siblings().show(500):$(this).siblings().hide(500)}),$(".kzryListBtn").click(function(){$(".kzryMsgBox").show(500)}),$(".kzryMsgBox>button").click(function(){$(".kzryMsgBox").hide(500)}),addProvinceLi(),$.get("./geojson/world.json",function(t){simpleMap(mapName,t),setData(t)}),lazyload()}),simpleMap=function(t,a){echarts.registerMap(t,a),option={series:{type:"map",top:geoTop,left:geoLeft,zoom:.9,map:t}};var e=echarts.init(document.getElementById("main"));e.setOption(option)},setData=function(t){getData1(dataPath+"sortinfo").then(function(a){tryFun=function(){var e=echarts.init(document.getElementById("main"));echarts.registerMap(mapName,t);for(var n={China:[113.5,63.48],Japan:[138.76,48.67],Australia:[135.13,-18.3],USA:[-80.02,48.54],Canada:[-103.98,70.33],India:[76.5,29.48],Germany:[10.76,63.67],Italy:[12.5,48],Cambodia:[104,18]},o=function(t){for(var a=[],e=0;e<t.length;e++){var o=n[t[e].name];o&&a.push({name:t[e].name,value:o.concat(t[e].value)})}return a},i=[],r=0;r<a.length;r++)i.push(a[r].area);var s=new Array;for(r in ENname){if("China"==ENname[r])var l=[200,230],c=32;else if("Cambodia"==ENname[r]||"Italy"==ENname[r])var l=[50,57],c=14;else var l=[100,115],c=18;var p={type:"scatter",coordinateSystem:"geo",data:o([{name:ENname[r],value:2}]),symbol:"image://./image1080/6-tap.png",symbolSize:l,label:{normal:{show:!0,formatter:CNname[r]+"\n"+sum[r]+"家\n",textStyle:{color:"#000",fontSize:c}}}};s.push(p)}!function(){for(var t=new Array,a=0;a<i.length;a++){"USA"==ENname[a]&&(ENname[a]="United States of America");var e=ENname[a],n=new Object;n.name=e,n.value=1,t.push(n)}var n={type:"map",map:"world",zoom:.9,top:geoTop,left:geoLeft,itemStyle:{normal:{borderColor:borderColor,areaColor:MapColorL}},data:t};s.push(n)}(),option={title:{text:"慕思招商系统",top:50,left:260,textStyle:{color:"#dcdcdc",fontSize:40,fontWeight:300}},visualMap:{type:"piecewise",left:40,bottom:50,itemWidth:40,itemHeight:40,orient:"vertical",textStyle:{color:"#e5e5e5",fontSize:26},outOfRange:{color:pointColor,fontSize:30},pieces:[{min:1,max:10,label:"已开发区域"},{min:0,max:0,label:"未开发区域"}],color:[MapColorR,MapColorL]},toolbox:{show:!1,left:"left",top:"top",feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},geo:{type:"map",map:mapName,zoom:.9,top:geoTop,left:geoLeft,itemStyle:{normal:{borderColor:borderColor,areaColor:MapColorL}}},series:s},e.setOption(option),load(),e.on("click",function(t){var a=t.name;"USA"==a&&(a="United States of America");switch(a){case"China":location.href="html/country.html?name=China&index=1";break;case"United States of America":location.href="html/othercountry.html?name=USA&CNname="+encodeURIComponent("美国")+"&index=1";break;case"Japan":location.href="html/othercountry.html?name=Japan&CNname="+encodeURIComponent("日本")+"&index=1";break;case"Australia":location.href="html/othercountry.html?name=Australia&CNname="+encodeURIComponent("澳大利亚")+"&index=1";break;case"Germany":location.href="html/othercountry.html?name=German&CNname="+encodeURIComponent("德国")+"&index=1";break;case"India":location.href="html/othercountry.html?name=India&CNname="+encodeURIComponent("印度")+"&index=1";break;case"Canada":location.href="html/othercountry.html?name=Canada&CNname="+encodeURIComponent("加拿大")+"&index=1";break;case"Italy":alert("该国家地图数据暂时缺失");break;case"Cambodia":alert("该国家地图数据暂时缺失")}})};try{tryFun()}catch(t){alert("你的网络有问题。")}})},addStoreMsg=function(){var t={};getData1(dataPath+"sortinfo",t).then(function(t){var a=[];for(n in t){var e=t[n].qtyflags;a.push(e[0].QTY)}for(var n=0;n<a.length;n++)for(var o=n;o<a.length;o++){var i=parseInt(a[n]),r=parseInt(a[o]);if(i<r){var e=i;a[n]=r,a[o]=i;var s=t[n];t[n]=t[o],t[o]=s}}for(var l=[],c=0,p=[],d=[],n=0;n<t.length;n++){var e=t[n].qtyflags,h=[],m=0;for(o=0;o<e.length;o++)void 0!=e[o].QTY?(h.push(e[o].QTY),m+=parseInt(e[o].QTY)):h.push(0);d.push(m);var u=t[n].area;u=u.split("|"),countryName=u[1],ENname.push(u[0]),CNname.push(u[1]),sum.push(parseInt(h[0])+parseInt(h[1])),c+=parseInt(h[0])+parseInt(h[1]);var f="<li><h3><strong>"+countryName+'</strong>共有<span class="storeSum">'+d[n]+'</span>家店，其中</h3><ul class="clearfix"><li><h4><span>'+h[0]+"</span>家</h4><p>加盟店</p></li><li><h4><span>"+h[1]+"</span>家</h4><p>直营店</p></li></ul></li>",b="<li>"+countryName+"</li>";p+=b,l+=f}$(".countryListBox").append(l),$(".countrysList").append(p),$(".mapTitle strong").html(c),countryBtn()})},addOtherCountry=function(t){var a={country:t};getData1(dataPath+"distributeinfo",a).then(function(t){$(".provincesList").empty(),$(".citysList").empty();var a="";for(i in t){var e=t[i].cityName;e=e.split("|"),e=e[0];var n="<li>"+e+"</li>";a+=n}$(".provincesList").append(a),provinceBtn()})};var obj,fn;zsryBtn();