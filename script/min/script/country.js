function showManMsg(){getManMsg(".li1"),$(".managerListBox li").click(function(){$(this).addClass("on"),$(this).siblings().removeClass("on"),getManMsg(this)})}function getManMsg(e){var a=$(e).find(".manName").text(),n=$(e).find(".manPhone").text(),t=$(e).find(".manPhoto").attr("src"),o=$(e).find(".manPhoto").attr("title"),r=$(e).find(".manPianqu").text(),s=$(e).find(".manArea").text(),l={mangerArea:s,bigArea:r};getData1(dataPath+"marketsinfo",l).then(function(e){console.log(e);var l=e.develop.split(","),c=l.join("、"),h=[],m=e.undevelop;for(i in m)h.push(m[i].AREA);var g=h.join("、");$(".name").html(a),$(".pianqu").html(r),$(".area").html(s),$(".phone").html(n),$(".photo").css({background:"url("+t+")","background-size":"100% 100%"}),$(".qr").attr("src",o),$(".developList").html(c),$(".undevelopList").html(g)})}function load(){$(".bottomNav").css({background:"url(../image1080/7-menuon.png) no-repeat","background-size":"1144px 140px"})}var geoTop="center",geoLeft="center",zoom=1.1,visualMapBottom=80,visualMapLeft=160,visualMapOrient="vertical",nomore=!0,sel=[],col=["#d21819","#8265b9","#ed9740","#d1ed40","#7bed40","#40ed5d","#40eeb3","#40cfed","#0e47a1","#1976d3","#673bb7","#8e24aa","#d81a60","#ec407a","#d32f2e","#f6410a","#fe5722","#fb8c00","#fec107","#f3ce37","#525252"];$(document).ready(function(){document.addEventListener("plusready",function(){plus.key.addEventListener("backbutton",function(){alert("back")})}),$(".managerListBox").height(height-220),$(".storeContent").height(height-362),$(".deviceHeight").css("height",height-40-deviceTopHeight);decodeURIComponent(window.location.search.substr(6));getChina(),$(".managerList").click(function(){var e=$("#managerListBox").css("margin-left");"0px"==e?($(".visualMap").show(),geoLeft="center",zoom=1.1,getChina(),$(this).removeClass("managerList2"),$("#managerListBox").css("margin-left","-1200px"),$("#main").css({width:"100%","margin-left":"0px"})):($(".visualMap").hide(),geoLeft="center",zoom=1,getChina(),$(this).addClass("managerList2"),$("#managerListBox").css("margin-left","0px"),$("#main").css({width:"790px","margin-left":"1200px"}))}),$("#managerListBox").css("height",height)});var name=getQueryString("name");"United States of America"==name&&(name="USA");var province={"广东":"guangdong","安徽":"anhui","澳门":"aomen","北京":"beijing","重庆":"chongqing","福建":"fujian","甘肃":"gansu","广西":"guangxi","贵州":"guizhou","海南":"hainan","河北":"hebei","黑龙江":"heilongjiang","河南":"henan","湖北":"hubei","湖南":"hunan","江苏":"jiangsu","江西":"jiangxi","吉林":"jilin","辽宁":"liaoning","内蒙古":"neimenggu","宁夏":"ningxia","青海":"qinghai","山东":"shandong","上海":"shanghai","山西":"shanxi","四川":"sichuan","天津":"tianjin","香港":"xianggang","新疆":"xinjiang","西藏":"xizang","云南":"yunnan","浙江":"zhejiang"};getChina=function(){var e={country:"中国"};getData1(dataPath+"managerbyinfo",e).then(function(e){function a(){for(var a=0;a<e.length;a++){if(0==a)var n="li1 on";else var n="";var t='<li class="'+n+'"><img class="manPhoto" title="'+picPath+e[a].mulu+"/"+e[a].qr+'" src="'+picPath+e[a].mulu+"/"+e[a].headPhoto+'" alt="" /><p>姓名：<span class="manName">'+e[a].name+'</span></p><p>电话：<span class="manPhone">'+e[a].phone+'</span></p><p>片区：<span class="manArea">'+e[a].city+'</span></p><p>负责区域：<span class="manPianqu">'+c[a]+"</span></p></li>";$(".managerListBox").append(t)}showManMsg()}function n(){for(var a=new Array,n=0;n<e.length;n++){var t={name:c[n],top:geoTop,left:geoLeft,type:"map",zoom:zoom,map:name,scaleLimit:{min:.6,max:20},label:{normal:{show:!0,textStyle:{color:"#e5e5e5",fontSize:12}},emphasis:{show:!0,textStyle:{color:"#525252",fontSize:12}}},itemStyle:{normal:{borderColor:borderColor,areaColor:MapColorL}},data:r[n]};a.push(t)}return a}console.log(e),$(".managerList").click(function(){var e=$(".managerListBox").attr("id");"addList"==e&&(a(),$(".managerListBox").attr("id",""))});for(var t=[],i=0;i<e.length;i++){var o=e[i].city.split(",");t.push(o)}var r=new Array;r.length=t.length;for(var i=0;i<t.length;i++)r[i]=new Array;for(var i=0;i<t.length;i++)for(var s=0;s<t[i].length;s++){var l={name:t[i][s],value:i};r[i].push(l)}for(var c=[],i=0;i<e.length;i++)c.push(e[i].area);n();for(var h=[],m=[],g=[],i=0;i<c.length;i++){m.push(col[i]),sel.push(!0);var l={min:i,max:i,label:c[i]};h.push(l);var p='<li class="'+i+'"><span></span>'+c[i]+"</li>";g.push(p)}g.push('<li class="all"><span></span>全部</li>'),setOption(h,n,e,c,m,g)})},setOption=function(e,a,n,t,o,r){var s=echarts.init(document.getElementById("main"));$.get("../geojson/country/"+name+".json",function(l){tryFun=function(){echarts.registerMap(name,l),option={title:{text:"中国地图",top:50,left:260,sublink:"http://www.musi.com",textStyle:{color:"#dcdcdc",fontSize:40,fontWeight:300}},tooltip:{trigger:"item",showDelay:0,transitionDuration:.2,trigger:"item",textStyle:{color:"#e5e5e5",fontSize:28},extraCssText:"border: 1px solid #e5e5e5;border-radius: 12px;background: rgba(178,178,178,0.5)",formatter:function(e){return tooltipData(e)}},visualMap:{show:!1,type:"piecewise",align:"left",hoverLink:!1,top:"center",right:visualMapLeft,itemWidth:40,itemHeight:40,orient:visualMapOrient,textStyle:{color:"#dcdcdc",fontSize:30},pieces:e,color:o},toolbox:{show:!1,left:"left",top:"top",feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},series:a()},s.setOption(option),load(),nomore&&(visualMapAct(r,n,o),nomore=!1),$(".visualMap>li").click(function(){var a=$(this).attr("class"),n={};if("all"==a)for(i in e)n[i]=!0;else{for(i in e)n[i]=!1;n[parseInt(a)]=!0}s.dispatchAction({type:"selectDataRange",selected:n})}),s.on("click",function(e){var a=e.name,n=province[a];if(void 0==n&&(n="shanxi1"),"China"==name)switch(n){case"tianjin":location.href="city.html?id=000001&name="+encodeURIComponent("天津市")+"&provinceName=天津&index=2";break;case"beijing":location.href="city.html?id=000002&name="+encodeURIComponent("北京市")+"&provinceName=北京&index=2";break;case"chongqing":location.href="city.html?id=000003&name="+encodeURIComponent("重庆市")+"&provinceName=重庆&index=2";break;case"shanghai":location.href="city.html?id=000004&name="+encodeURIComponent("上海市")+"&provinceName=上海&index=2";break;case"xianggang":location.href="city.html?id=000005&name="+encodeURIComponent("香港")+"&provinceName=香港&index=2";break;case"aomen":location.href="city.html?id=000006&name="+encodeURIComponent("澳门")+"&provinceName=澳门&index=2";break;default:location.href="province.html?name="+encodeURIComponent(a)+"&id="+n+"&index=2"}}),tooltipData=function(e){for(var a={},i=e.name,o=0;o<n.length;o++)n[o].city.indexOf(i)!=-1&&(a=n[o]);for(var o=0;o<t.length;o++)return"所属大区："+a.area+"<br/>招商经理："+a.name+"<br/>省级行政区："+a.city+"<br/>加盟店数量："+a.qty+"<br/>加盟品牌："+a.brands.slice(0,26)}};try{tryFun()}catch(e){alert("你的网络有问题")}})},visualMapAct=function(e,a,n){$(".visualMap").append(e);var t=$(".visualMap").css("height");$(".visualMap").css("margin-top",parseInt(t)/2*-1);var o=[];for(j=a.length;j>0;j--)o.push(j);for(i=0;i<a.length;i++){var r=".visualMap li:nth-child("+o[i]+") span";$(r).css("background",n[i])}};