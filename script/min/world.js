function lazyload(){countryBtn(),provinceBtn(),cityBtn(),ajaxObj={country:"中国"},barOption(ajaxObj,"")}function barOption(a,t){getData1(dataPath+"brandbyinfo",a).then(function(a){tryFun=function(){canClick=!0;for(var e=a.area,n=[],o=0;o<e.length;o++)n.push(e[o][0]);for(var i=[],r=a.brandMsg,o=0;o<r.length;o++)i.push(r[o].brand);i.unshift("全部"),brandState&&(brandsArr=i,brandState=!1),brandList=i,addBrandList(brandsArr,t),barList();var s=[],l=[];l.length=r.length;for(var o=0;o<r.length;o++)l[o]=[],s.push(r[o].brandInfo);for(var o=0;o<s.length;o++)for(var c=0;c<s[o].length;c++)l[o].push(s[o][c].QTY);var p=[];l.unshift(p);for(var d=[],o=0;o<brandList.length;o++){var h={name:brandList[o],type:"bar",stack:"总量",label:{normal:{show:labelShow,position:"right"}},data:l[o]};d.push(h)}var m=echarts.init(document.getElementById("barGraph"));Baroption={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"6%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value",axisLabel:{textStyle:{color:textColor,fontSize:12}},axisLine:{lineStyle:{color:textColor}},splitLine:{show:!1}},yAxis:{type:"category",axisLabel:{textStyle:{color:textColor,fontSize:12}},axisLine:{lineStyle:{color:textColor,fontSize:12}},axisTick:{show:!1},inverse:!0,data:n},series:d},m.setOption(Baroption)};try{tryFun()}catch(a){alert("你的网络有问题。")}})}function addBrandList(a,t){$(".barLengend").empty();var e="";for(i in a){var n='<li class="li'+i+'"><span></span>'+a[i]+"</li>";e+=n}if($(".barLengend").append(e),""!=t)for(i in a)a[i]==t&&(console.log(i),$(".barLengend .li"+i).addClass("on"))}function addProvinceLi(){$(".provincesList").empty();for(var a="",t=0;t<provinces.length;t++){var e="<li><p>"+provinces[t]+"</p></li>";a+=e}$(".provincesList").append(a),provinceBtn(),ajaxObj={country:"中国",province:"广东"},getData1(dataPath+"brandbyinfo",ajaxObj).then(function(a){$(".citysList").empty();for(var t=a.area,e="",n=0;n<t.length;n++){var o="<li><p>"+t[n][0]+"</p></li>";e+=o}$(".citysList").append(e)})}function countryBtn(){$(".countrysList li").click(function(){labelShow=!1,$(".barLengend").addClass("on"),delete ajaxObj.brand;var a=$(this).text();"中国"==a?($(".hideBox").show(),addProvinceLi(),$(".citysListBox").hide()):($(".hideBox").hide(),addOtherCountry(a)),$(".provinceBtn").text("省"),$(this).parent().hide(500);var t=$(this).text();$(this).parent().siblings().text(t),$(".unDevelopBox").hide(),ajaxObj={country:t},barOption(ajaxObj,"")})}function provinceBtn(){$(".provincesList li").click(function(){labelShow=!1,$(".barLengend").addClass("on"),delete ajaxObj.brand,$(".citysListBox > h2").text("市"),$(this).parent().hide(500),$(".citysListBox").show(500);var a=$(this).text();$(this).parent().siblings().text(a);var t={country:"中国",province:a};getData1(dataPath+"distributeinfo",t).then(function(a){a=a.detailCount;for(var t="",e=0;e<a.length;e++)t=t+"<li>"+a[e].cityName+"</li>";$(".citysList").empty(),$(".citysList").append(t),cityBtn()});var t={province:a};getData1(dataPath+"voidmarkets",t).then(function(a){var t=a.unDevelop;t=t.split(",");for(var e="",n=0;n<t.length;n++){var o="<li>"+t[n]+"</li>";e+=o}$(".unDevelopBox ul").empty(),$(".unDevelopBox ul").append(e)}),$(".unDevelopBox").show(),ajaxObj={country:"中国",province:a},barOption(ajaxObj,"")})}function cityBtn(){$(".citysList li").click(function(){labelShow=!1,$(".barLengend").addClass("on"),delete ajaxObj.brand,$(this).parent().hide(500);var a=$(this).text();$(this).parent().siblings().text(a);var t=$(".provinceBtn").text();$(".unDevelopBox").hide(),ajaxObj={country:"中国",province:t,city:a},barOption(ajaxObj,"")})}function barList(){$(".barLengend li").off("click").click(function(){if(canClick){canClick=!1;var a=$(this).text();"全部"==a?(labelShow=!1,$(".barLengend").addClass("on"),delete ajaxObj.brand,barOption(ajaxObj,"")):(labelShow=!0,$(".barLengend").removeClass("on"),$(this).addClass("on"),$(this).siblings().removeClass("on"),ajaxObj.brand=a,barOption(ajaxObj,a))}})}function load(){$(".barGraphBox").css({background:"url(image1080/1-background2.png) no-repeat","background-size":"100% 100%"}),$(".bottomNav").css({background:"url(image1080/7-menuon.png) no-repeat","background-size":"1144px 140px"})}var geoTop=170,geoLeft=20,selectedMode=!0,mapName="world",wjson,provinces=["广东","安徽","澳门","北京","重庆","福建","甘肃","广西","贵州","海南","河北","黑龙江","河南","湖北","湖南","江苏","江西","吉林","辽宁","内蒙古","宁夏","青海","山东","上海","山西","四川","天津","香港","新疆","西藏","云南","浙江"],CNname=[],ENname=[],sum=[],brandsArr,labelShow=!1,ajaxObj={},brandList=[],brandState=!0,canClick=!0;$(document).ready(function(){var a=document.documentElement.clientHeight;$(".deviceHeight").css("height",a-40-deviceTopHeight),$("#worldBody").height(a),$(".barGraphBox").height(a-230),$(".barGraph").height(a-280),$(".unDevelopBox").height(a-200),addStoreMsg(),$("#slidBar>.list").click(function(){$(this).siblings().removeClass("on"),$(this).addClass("on"),$(".listBox").show(500)}),$("#slidBar>.map").click(function(){$(this).siblings().removeClass("on"),$(this).addClass("on"),$(".listBox").hide(500)}),$(".countryListBox").scroll(function(){var a=$(this).scrollTop();a>50?$(".scroll1").addClass("scrollTop"):$(".scroll1").removeClass("scrollTop"),a>1320?$(".scroll2").removeClass("scrollBottom"):$(".scroll2").addClass("scrollBottom")}),$(".selectBox h2").click(function(){var a=$(this).siblings().css("display");$(".selectBox ul").hide(),"none"==a?$(this).siblings().show(500):$(this).siblings().hide(500)}),addProvinceLi(),$.get("./geojson/world.json",function(a){simpleMap(mapName,a),setData(a)}),lazyload()}),simpleMap=function(a,t){echarts.registerMap(a,t),option={series:{type:"map",top:geoTop,left:geoLeft,zoom:.9,map:a}};var e=echarts.init(document.getElementById("main"));e.setOption(option)},setData=function(a){getData1(dataPath+"sortinfo").then(function(t){tryFun=function(){var e=echarts.init(document.getElementById("main"));echarts.registerMap(mapName,a);for(var n={China:[113.5,63.48],Japan:[138.76,48.67],Australia:[135.13,-18.3],USA:[-80.02,48.54],Canada:[-103.98,70.33],India:[76.5,29.48],Germany:[10.76,63.67],Italy:[12.5,49],Cambodia:[104,21]},o=function(a){for(var t=[],e=0;e<a.length;e++){var o=n[a[e].name];o&&t.push({name:a[e].name,value:o.concat(a[e].value)})}return t},i=[],r=0;r<t.length;r++)i.push(t[r].area);var s=new Array;console.log(ENname);for(r in ENname){if("China"==ENname[r])var l=[200,230],c=32;else if("Cambodia"==ENname[r]||"Italy"==ENname[r])var l=[50,57],c=14;else var l=[100,115],c=18;var p={type:"scatter",coordinateSystem:"geo",data:o([{name:ENname[r],value:2}]),symbol:"image://./image1080/6-tap.png",symbolSize:l,label:{normal:{show:!0,formatter:CNname[r]+"\n"+sum[r]+"家\n",textStyle:{color:"#000",fontSize:c}}}};s.push(p)}!function(){for(var a=new Array,t=0;t<i.length;t++){"USA"==ENname[t]&&(ENname[t]="United States of America");var e=ENname[t],n=new Object;n.name=e,n.value=1,a.push(n)}var n={type:"map",map:"world",zoom:.9,top:geoTop,left:geoLeft,itemStyle:{normal:{borderColor:borderColor,areaColor:MapColorL}},data:a};s.push(n)}(),option={title:{text:"慕思招商系统",top:50,left:260,textStyle:{color:"#dcdcdc",fontSize:40,fontWeight:300}},visualMap:{type:"piecewise",left:40,bottom:50,itemWidth:40,itemHeight:40,orient:"vertical",textStyle:{color:"#e5e5e5",fontSize:26},outOfRange:{color:pointColor,fontSize:30},pieces:[{min:1,max:10,label:"已开发区域"},{min:0,max:0,label:"未开发区域"}],color:[MapColorR,MapColorL]},toolbox:{show:!1,left:"left",top:"top",feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},geo:{type:"map",map:mapName,zoom:.9,top:geoTop,left:geoLeft,itemStyle:{normal:{borderColor:borderColor,areaColor:MapColorL}}},series:s},e.setOption(option),load(),e.on("click",function(a){var t=a.name;"USA"==t&&(t="United States of America");switch(t){case"China":location.href="html/country.html?name=China&index=1";break;case"United States of America":location.href="html/othercountry.html?name=USA&CNname="+encodeURIComponent("美国")+"&index=1";break;case"Japan":location.href="html/othercountry.html?name=Japan&CNname="+encodeURIComponent("日本")+"&index=1";break;case"Australia":location.href="html/othercountry.html?name=Australia&CNname="+encodeURIComponent("澳大利亚")+"&index=1";break;case"Germany":location.href="html/othercountry.html?name=German&CNname="+encodeURIComponent("德国")+"&index=1";break;case"India":location.href="html/othercountry.html?name=India&CNname="+encodeURIComponent("印度")+"&index=1";break;case"Canada":location.href="html/othercountry.html?name=Canada&CNname="+encodeURIComponent("加拿大")+"&index=1";break;case"Italy":alert("该国家地图数据暂时缺失");break;case"Cambodia":alert("该国家地图数据暂时缺失")}})};try{tryFun()}catch(a){alert("你的网络有问题。")}})},addStoreMsg=function(){var a={};getData1(dataPath+"sortinfo",a).then(function(a){var t=[];for(n in a){var e=a[n].qtyflags;t.push(e[0].QTY)}for(var n=0;n<t.length;n++)for(var o=n;o<t.length;o++){var i=parseInt(t[n]),r=parseInt(t[o]);if(i<r){var e=i;t[n]=r,t[o]=i;var s=a[n];a[n]=a[o],a[o]=s}}for(var l=[],c=0,p=[],d=[],n=0;n<a.length;n++){var e=a[n].qtyflags,h=[],m=0;for(o=0;o<e.length;o++)void 0!=e[o].QTY?(h.push(e[o].QTY),m+=parseInt(e[o].QTY)):h.push(0);d.push(m);var u=a[n].area;u=u.split("|"),countryName=u[1],ENname.push(u[0]),CNname.push(u[1]),sum.push(parseInt(h[0])+parseInt(h[1])),c+=parseInt(h[0])+parseInt(h[1]);var b="<li><h3><strong>"+countryName+'</strong>共有<span class="storeSum">'+d[n]+'</span>家店，其中</h3><ul class="clearfix"><li><h4><span>'+h[0]+"</span>家</h4><p>加盟店</p></li><li><h4><span>"+h[1]+"</span>家</h4><p>直营店</p></li></ul></li>",v="<li>"+countryName+"</li>";p+=v,l+=b}$(".countryListBox").append(l),$(".countrysList").append(p),$(".mapTitle strong").html(c),countryBtn()})},addOtherCountry=function(a){var t={country:a};getData1(dataPath+"distributeinfo",t).then(function(a){$(".provincesList").empty(),$(".citysList").empty();var t="";for(i in a){var e=a[i].cityName;e=e.split("|"),e=e[0];var n="<li>"+e+"</li>";t+=n}$(".provincesList").append(t),provinceBtn()})};var obj,fn;