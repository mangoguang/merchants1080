function load(){$(".bottomNav").css({background:"url(../image1080/7-menuon.png) no-repeat","background-size":"1144px 140px"})}areaColor=MapColorL;var geoTop=130,geoLeft="center",zoom=1.1,visualMapBottom=180,visulMapR=80,center,tude={},indexName,height=document.documentElement.clientHeight,urlStr=decodeURIComponent(window.location.search.substr(11)),paramArr=urlStr.split("="),paramArr1=paramArr[2].split("&"),provinceName=paramArr1[0],cityName=paramArr[1].split("&",1).toString();indexName=cityName,$(document).ready(function(){function e(){insertData(t)}$(".storeList").height(height-220),$(".storeContent").height(height-400),$(function(){$(".flexslider").flexslider({directionNav:!0,pauseOnAction:!1})}),managerMsg(provinceName),$(".deviceHeight").css("height",height);var t=getQueryString("id");switch(t){case"000001":t="tianjin";break;case"000002":t="beijing";break;case"000003":t="chongqing";break;case"000004":t="shanghai";break;case"000005":t="xianggang";break;case"000006":t="aomen"}$("h2.title .city").text(cityName+"地图"),e();var o={country:"中国",province:provinceName,city:cityName};getData1(dataPath+"gettude",o).then(function(e){tude=e})}),insertData=function(e){function t(e){var t={storeName:e};getData1(dataPath+"storeinfo",t).then(function(e){console.log(e);var t="",o=e.pictures,a=o.split(","),i=e.mulu;for(s=0;s<a.length;s++){var r='<li class="li'+s+'"></li>';t+=r}$(".slides").append(t);for(s in a)$(".slides .li"+s).css("background","url("+picPath+i+"/"+a[s]+") 50% 0 no-repeat");$(".photo").css("background","url("+picPath+i+"/"+e.photo+") no-repeat"),$(".storeTit").html(e.storeName),$(".storePhone").html(e.phone),$(".storeAddress").html(e.address),$(".storeArea").html(e.storeArea),$(".startTime").html(e.startTime);var n=e.brands.split(",");$(".brandList").empty();for(var s=0;s<n.length;s++){var r="<li>"+n[s]+"</li>";$(".brandList").append(r)}})}var o=0,a=0,i={country:"中国",province:provinceName,city:cityName};getData1(dataPath+"areadistribute",i).then(function(i){function r(e,i){i=i.info;for(var r=[],s=0;s<i.length;s++)for(var l=i[s].stores,c=0;c<l.length;c++)r.push(l[c]);$("ul.storeList li").remove();for(var s=0;s<r.length;s++){if(0==s)var m='<li class="li1 on">';else var m="<li>";var p=m+"<h3>"+r[s].STORE+"</h3><p>电话："+r[s].PHONE+"</p><p>地址："+r[s].ADDRESS+"</p></li>";$("ul.storeList").append(p)}$(".storeList li").click(function(){$(this).addClass("on"),$(this).siblings().removeClass("on");var e=$(".storeList .on").find("h3").html();t(e)});for(var g=[],h=[],s=0;s<r.length;s++){if("综合店"==r[s].PROPERTY){a++;var u="image://../image1080/9-yellow.png"}else{o++;var u="image://../image1080/10-pink.png"}var f={name:s+"nameMap",type:"scatter",coordinateSystem:"geo",zlevel:12,data:[{name:r[s].STORE,value:[r[s].JINGDU,r[s].WEIDU]}],symbol:u,symbolSize:[32,40]};g.push(f)}for(var s=0;s<i.length;s++){var d={name:i[s].countyName,value:1};h.push(d)}!function(){var t={name:"113.75824,23.284367",top:geoTop,left:geoLeft,zoom:zoom,center:center,type:"map",map:e,label:{normal:{show:!0},emphasis:{show:!0}},itemStyle:{normal:{borderColor:borderColor,areaColor:n}},data:h};g.push(t)}(),setOption(e,g,i),tooltipData=function(e){for(var t=e.name,o="所属区县："+t+"<br/>进驻品牌：",a=[],r="",n=[],s=[],l=0;l<i.length;l++)n.push(i[l].countyName),s.push(i[l].brands);if(n.indexOf(t)!=-1){for(var l=0;l<n.length;l++)if(t==n[l])for(var c=0;c<s[l].length;c++)r=r+"<br/>"+s[l][c].BRAND+"店铺："+s[l][c].QTY+"家",a.push(s[l][c].BRAND);a=a.join("、"),o=o+a+r}else for(var o=t,l=0;l<i.length;l++)t==i[l].STORE&&(o+="<br/>"+i[l].ADDRESS);return o}}if(0==i.haveSubArea)var n=MapColorR;else var n=MapColorL;r(e,i),$(".bigger").off("click").click(function(){zoom+=1,r(e,i),$(".smaller").show()}),$(".smaller").off("click").click(function(){zoom-=1,r(e,i),zoom<=1.1&&$(".smaller").hide()}),$(".slidBar").off("click").click(function(){var t=$(".storeDetailBox").css("margin-left");"0px"==t?($(".manageMsgBox").show(),$("#main").css({width:"100%","margin-left":"0px"}),geoLeft="center",zoom=1.1,geoTop=130,$(this).removeClass("Right2"),visualMapBottom=180,visulMapR=80,r(e,i),$(".storeDetailBox").css("margin-left","-1200px"),$(".symbol").css({bottom:"140px",right:"105px"})):($(".manageMsgBox").hide(),$("#main").css({width:"790px","margin-left":"1200px"}),geoLeft="center",zoom=.8,geoTop=100,$(this).addClass("Right2"),visualMapBottom="bottom",visulMapR=-280,r(e,i),$(".storeDetailBox").css("margin-left","0px"),$(".symbol").css({bottom:"30px",right:"100px"}))}),$(".symbol .li1 span").text("("+o+")"),$(".symbol .li2 span").text("("+a+")"),$(function(){var e=$(".storeList .on").find("h3").html();t(e)})})},setOption=function(e,t,o){var a=echarts.init(document.getElementById("main"));$.get("../geojson/city/"+e+".json",function(o){echarts.registerMap(e,o),option={title:{text:cityName+"加盟商分布",top:50,left:260,sublink:"http://www.musi.com",textStyle:{color:"#e5e5e5",fontSize:40,fontWeight:300}},tooltip:{trigger:"item",showDelay:0,hideDelay:1e3,transitionDuration:.2,textStyle:{color:"#e5e5e5",fontSize:28},trigger:"item",extraCssText:"border: 1px solid #e5e5e5;border-radius: 12px;background: rgba(110,110,110,0.2)",formatter:function(e){return tooltipData(e)}},visualMap:{type:"piecewise",left:visulMapR,top:visualMapBottom,align:"left",itemWidth:40,itemHeight:40,orient:"vertical",textStyle:{color:"#e5e5e5",fontSize:26},pieces:[{min:0,max:0,label:"未开发区域"},{min:1,max:1,label:"已开发区域"}],outOfRange:{color:pointColor},color:[MapColorR,MapColorL]},toolbox:{show:!0,left:"left",top:"top",feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},geo:{map:e,top:geoTop,left:geoLeft,zoom:zoom,center:center,label:{emphasis:{show:!1}},itemStyle:{normal:{color:MapColorL},emphasis:{color:MapColorL}}},series:t},a.setOption(option),a.on("click",function(t){if("map"==t.componentSubType&&indexName!=t.name&&(insertData(e),null!=tude)){var o=tude[t.name];center=[o[1],o[0]],indexName=t.name}})})},managerMsg=function(e){var t={province:e};getData1(dataPath+"managerbyprovince",t).then(function(e){for(var t=0;t<e.length;t++)if(e[t].city.indexOf(cityName)>=0){var o=e[t];$(".img1").attr("src",picPath+o.mulu+"/"+o.pics),$(".img2").attr("src",picPath+o.mulu+"/"+o.qr),$(".name").text(o.manger),$(".area").text(o.area),$(".provinces").text(o.city),$(".phone").text(o.phone)}})};